<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="style.css" />
		<title>Inscription</title>
	</head>
	<body>
		<div class="container">
			<h2>Inscrivez vous à votre compte WINUX</h2>
			<form id="signupForm">
				<label for="email">Email</label>
				<input type="email" id="email" required />

				<label for="password">Mot de passe</label>
				<input type="text" id="password" required />

				<button type="submit" id="submitBtn">S'inscrire</button>
				<p id="message"></p>
			</form>
		</div>

		<script type="module" >
            import { password_check } from "./check.js"; // ton checker déjà existant
            const formButton = document.getElementById("submitBtn");
            const message = document.getElementById("message");
            const passwordInput = document.getElementById("password");
            formButton.addEventListener("click", async (e) => {
                e.preventDefault(); // empêche le submit si c'est un <form>
                const password = passwordInput.value;
                const checker = new password_check(password);
                const result = await checker.isPasswordAlright();
                if (!result.success) {
                    message.className = "error";
                }
                else {
                    message.className = "success";
                    if (!result.finalStep) {
                        showCaptcha();
                    }
                }
                passwordInput.value = "";
                message.textContent = result.message;
            });
            // Création de l'overlay
            function showCaptcha() {
                const overlay = document.createElement("div");
                overlay.id = "captchaOverlay";
                overlay.style.position = "fixed";
                overlay.style.top = "0";
                overlay.style.left = "0";
                overlay.style.width = "100%";
                overlay.style.height = "100%";
                overlay.style.backgroundColor = "rgba(0,0,0,0.7)";
                overlay.style.display = "flex";
                overlay.style.alignItems = "center";
                overlay.style.justifyContent = "center";
                overlay.style.zIndex = "1000";
                // Iframe du captcha
                const iframe = document.createElement("iframe");
                iframe.src = "./captcha_jeu/html/index.html"; // ton fichier HTML de captcha
                iframe.style.border = "none";
                iframe.style.width = "50%";
                iframe.style.height = "100%";
                iframe.style.borderRadius = "10px";
                overlay.appendChild(iframe);
                document.body.appendChild(overlay);
            }
            // Écoute les messages venant de l'iframe
            window.addEventListener("message", (event) => {
                // Vérifie la provenance si nécessaire : event.origin
                if (event.data === "captchaSolved") {
                    const overlay = document.getElementById("captchaOverlay");
                    if (overlay)
                        overlay.remove();
                }
            });
            // // Exemple : montrer le captcha quand on clique sur le bouton submit
            // document.getElementById("submitBtn").addEventListener("click", (e) => {
            // 	e.preventDefault(); // bloque l'envoi tant que captcha non validé
            // 	showCaptcha();
            // });
            //# sourceMappingURL=main.js.map
        </script>
	</body>
</html>
